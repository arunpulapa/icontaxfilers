<div class="client-docs-page">
  <div class="client-docs-card">
    <!-- HEADER -->
    <header class="client-docs-header">
      <div class="header-left">
        <h1 class="page-title">Client Documents</h1>
        <p class="page-subtitle">
          Upload, organize, and manage documents securely for this client.
        </p>
      </div>

      <div class="header-right">
        <label class="field-label">Client ID</label>
        <div class="client-id-wrap">
          <span class="client-id-icon">üîë</span>
          <input
            type="text"
            [(ngModel)]="clientId"
            placeholder="Enter Client ID (GUID)"
            class="client-id-input"
          />
        </div>

        <div
          class="doc-count-pill"
          *ngIf="documents?.length"
        >
          <span class="doc-count-icon">üìÅ</span>
          <span>
            {{ documents.length }} document{{ documents.length > 1 ? 's' : '' }}
          </span>
        </div>
      </div>
    </header>

    <!-- MAIN LAYOUT -->
    <main class="client-docs-layout">
      <!-- LEFT: UPLOAD PANEL -->
      <section class="upload-panel">
        <div class="panel-header">
          <div>
            <h2 class="panel-title">Upload documents</h2>
            <p class="panel-subtitle">
              Select a document type and attach one or more files.
            </p>
          </div>

          <div class="secure-pill">
            <span class="secure-icon">‚ö°</span>
            <span>Secure upload</span>
          </div>
        </div>

        <!-- Document type -->
        <div class="form-group">
          <label class="field-label">
            Document type
          </label>
          <select
            class="select-input"
            [(ngModel)]="documentType"
          >
            <option value="">Select document type</option>
            <option *ngFor="let t of documentTypes" [value]="t">
              {{ t }}
            </option>
          </select>
          <div
            class="error-text"
            *ngIf="!documentType"
          >
            Required
          </div>
        </div>

        <!-- Drag & drop -->
        <div
          class="drop-zone"
          [class.drop-zone--active]="isDragOver"
          (dragover)="onDragOver($event)"
          (dragleave)="onDragLeave($event)"
          (drop)="onDrop($event)"
        >
          <div class="drop-icon">‚òÅÔ∏è</div>
          <p class="drop-title">Drag &amp; drop files here</p>
          <span class="drop-or">or</span>

          <button
            type="button"
            class="btn-ghost"
            (click)="fileInput.click()"
          >
            Choose files
          </button>

          <input
            #fileInput
            type="file"
            multiple
            (change)="onFilesSelected($event)"
            hidden
          />

          <p class="drop-hint">
            PDF, JPG, PNG, DOCX up to 10MB each.
          </p>
        </div>

        <!-- Selected files -->
        <div
          class="selected-files"
          *ngIf="selectedFiles.length"
        >
          <div class="selected-header">
            <span>Files to upload ({{ selectedFiles.length }})</span>
            <button
              type="button"
              class="btn-link-danger"
              (click)="clearSelected()"
            >
              Clear all
            </button>
          </div>

          <div
            class="file-item"
            *ngFor="let f of selectedFiles; let i = index"
          >
            <div class="file-icon">üìÑ</div>
            <div class="file-meta">
              <div class="file-name">{{ f.name }}</div>
              <div class="file-size">{{ f.size | number }} bytes</div>
            </div>
            <button
              type="button"
              class="file-remove"
              (click)="removeSelected(i)"
            >
              ‚úï
            </button>
          </div>
        </div>

        <!-- Upload button -->
        <div class="upload-footer">
          <p class="upload-note">
            Files are encrypted and stored securely.
          </p>

          <button
            type="button"
            class="btn-primary"
            (click)="upload()"
            [disabled]="
              !selectedFiles.length ||
              !documentType ||
              !clientId ||
              uploading
            "
          >
            <span class="btn-icon">‚¨ÜÔ∏è</span>
            <span *ngIf="!uploading">Upload documents</span>
            <span *ngIf="uploading">Uploading...</span>
          </button>
        </div>
      </section>

      <!-- RIGHT: EXISTING DOCUMENTS -->
      <section class="list-panel">
        <div class="panel-header">
          <div>
            <h2 class="panel-title">Existing documents</h2>
            <p class="panel-subtitle">
              Search, download, or remove uploaded files.
            </p>
          </div>

          <div class="search-group">
            <label class="field-label">Search</label>
            <div class="search-input-wrap">
              <span class="search-icon">üîç</span>
              <input
                type="text"
                class="search-input"
                [(ngModel)]="search"
                (input)="applyFilter()"
                placeholder="Search by name or type"
              />
              <button
                *ngIf="search"
                type="button"
                class="search-clear"
                (click)="search=''; applyFilter()"
              >
                ‚úï
              </button>
            </div>
          </div>
        </div>

        <div
          class="table-wrapper"
          *ngIf="filteredDocuments?.length; else emptyState"
        >
          <table class="docs-table">
            <thead>
              <tr>
                <th>File name</th>
                <th>Type</th>
                <th>Uploaded</th>
                <th class="th-actions">Actions</th>
              </tr>
            </thead>
            <tbody>
              <tr *ngFor="let d of filteredDocuments">
                <td>{{ d.fileName }}</td>
                <td>
                  <span class="type-pill">{{ d.documentType }}</span>
                </td>
                <td class="td-muted">
                  {{ d.uploadedAt | date: 'MM/dd/yy, HH:mm' }}
                </td>
                <td class="td-actions">
                  <button
                    type="button"
                    class="icon-btn"
                    (click)="download(d)"
                  >
                    ‚¨á
                  </button>
                  <button
                    type="button"
                    class="icon-btn icon-btn--danger"
                    (click)="delete(d)"
                  >
                    üóë
                  </button>
                </td>
              </tr>
            </tbody>
          </table>
        </div>

        <ng-template #emptyState>
          <div class="empty-state">
            <div class="empty-icon">üìÇ</div>
            <p class="empty-title">No documents uploaded yet.</p>
            <p class="empty-text">
              Use the upload panel above to add files for this client.
            </p>
          </div>
        </ng-template>
      </section>
    </main>

    <!-- LOADING OVERLAY -->
    <div
      class="loading-overlay"
      *ngIf="uploading"
    >
      <div class="spinner"></div>
    </div>
  </div>
</div>
